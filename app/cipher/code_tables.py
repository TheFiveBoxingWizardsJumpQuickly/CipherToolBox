def code_table_e(text, table_dict, bin_swap_dict, bin_code=False, delimiter=" "):
    from .common import replace_all
    converted = ""

    for s in text[:]:
        if s in table_dict:
            converted += table_dict[s] + delimiter
        else:
            converted += s + delimiter

    if bin_code:
        converted = replace_all(converted, bin_swap_dict)

    return converted


def code_table_d(text, table_dict, bin_swap_dict, bin_code=False, delimiter=" "):
    from .common import replace_all
    if bin_code:
        table_dict_inv = dict((replace_all(j, bin_swap_dict), i)
                              for (i, j) in table_dict.items())
    else:
        table_dict_inv = dict((j, i) for (i, j) in table_dict.items())

    text_rows = text.split('\n')

    decoded_rows = []
    for text_row in text_rows:
        code_string = text_row.split(delimiter)
        decoded_row = ""
        for s in code_string:
            if s in table_dict_inv:
                decoded_row += table_dict_inv[s]
            elif len(s) > 0:
                decoded_row += "[" + s + "]"
        decoded_rows.append(decoded_row)

    return '\n'.join(decoded_rows)


list_A = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"
list_a = list_A.lower()
list_0 = "0123456789"
list_0_for_atbash = "123456789"
list_hex = "0123456789abcdef"
list_base36 = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"
polybius_table = "ABCDEFGHIKLMNOPQRSTUVWXYZ"

morse_code_table = {
    'A': '.-', 'B': '-...', 'C': '-.-.', 'D': '-..', 'E': '.',  'F': '..-.',
    'G': '--.', 'H': '....', 'I': '..', 'J': '.---', 'K': '-.-', 'L': '.-..',
    'M': '--', 'N': '-.', 'O': '---', 'P': '.--.', 'Q': '--.-', 'R': '.-.',
    'S': '...', 'T': '-', 'U': '..-', 'V': '...-', 'W': '.--', 'X': '-..-',
    'Y': '-.--',   'Z': '--..',
    '0': '-----',  '1': '.----',  '2': '..---', '3': '...--',  '4': '....-',
    '5': '.....', '6': '-....',  '7': '--...',  '8': '---..', '9': '----.',
    '.': '.-.-.-', ',': '--..--', ':': '---...', '?': '..--..',
    "'": '.----.', '-': '-....-', '/': '-..-.', '@': '.--.-.', '=': '-...-',
    ' ': '/'
}

morse_wabun_code_table = {
    'イ': '.-', 'ロ': '.-.-', 'ハ': '-...', 'ニ': '-.-.', 'ホ': '-..',
    'ヘ': '.', 'ト': '..-..', 'チ': '..-.', 'リ': '--.', 'ヌ': '....',
    'ル': '-.--.', 'ヲ': '.---', 'ワ': '-.-', 'カ': '.-..', 'ヨ': '--',
    'タ': '-.', 'レ': '---', 'ソ': '---.', 'ツ': '.--.', 'ネ': '--.-',
    'ナ': '.-.', 'ラ': '...', 'ム': '-', 'ウ': '..-', 'ヰ': '.-..-',
    'ノ': '..--', 'オ': '.-...', 'ク': '...-', 'ヤ': '.--', 'マ': '-..-',
    'ケ': '-.--', 'フ': '--..', 'コ': '----', 'エ': '-.---', 'テ': '.-.--',
    'ア': '--.--', 'サ': '-.-.-', 'キ': '-.-..', 'ユ': '-..--', 'メ': '-...-',
    'ミ': '..-.-', 'シ': '--.-.', 'ヱ': '.--..', 'ヒ': '--..-', 'モ': '-..-.',
    'セ': '.---.', 'ス': '---.-', 'ン': '.-.-.', '゛': '..', '゜': '..--.',
    'ー': '.--.-', '、': '.-.-.-', '」': '.-.-..', '（': '-.--.-', '）': '.-..-.',
    '0': '-----',  '1': '.----',  '2': '..---', '3': '...--',  '4': '....-',
    '5': '.....', '6': '-....',  '7': '--...',  '8': '---..', '9': '----.',
}

bacon1_table = {
    'A': 'aaaaa', 'B': 'aaaab', 'C': 'aaaba', 'D': 'aaabb', 'E': 'aabaa',
    'F': 'aabab', 'G': 'aabba', 'H': 'aabbb', 'I': 'abaaa', 'J': 'abaaa',
    'K': 'abaab', 'L': 'ababa', 'M': 'ababb', 'N': 'abbaa', 'O': 'abbab',
    'P': 'abbba', 'Q': 'abbbb', 'R': 'baaaa', 'S': 'baaab', 'T': 'baaba',
    'U': 'baabb', 'V': 'baabb', 'W': 'babaa', 'X': 'babab', 'Y': 'babba', 'Z': 'babbb',
    ' ': '/'
}

bacon2_table = {
    'A': 'aaaaa', 'B': 'aaaab', 'C': 'aaaba', 'D': 'aaabb', 'E': 'aabaa',
    'F': 'aabab', 'G': 'aabba', 'H': 'aabbb', 'I': 'abaaa', 'J': 'abaab',
    'K': 'ababa', 'L': 'ababb', 'M': 'abbaa', 'N': 'abbab', 'O': 'abbba',
    'P': 'abbbb', 'Q': 'baaaa', 'R': 'baaab', 'S': 'baaba', 'T': 'baabb',
    'U': 'babaa', 'V': 'babab', 'W': 'babba', 'X': 'babbb', 'Y': 'bbaaa', 'Z': 'bbaab',
    ' ': '/'
}

abc012_table = {
    'A': '0', 'B': '1', 'C': '2', 'D': '3', 'E': '4',
    'F': '5', 'G': '6', 'H': '7', 'I': '8', 'J': '9',
    'K': '10', 'L': '11', 'M': '12', 'N': '13', 'O': '14',
    'P': '15', 'Q': '16', 'R': '17', 'S': '18', 'T': '19',
    'U': '20', 'V': '21', 'W': '22', 'X': '23', 'Y': '24', 'Z': '25',
    ' ': '/'
}

# International Radiotelephony Spelling Alphabet (NATO phonetic alphabet)
spelling_alphabet_icao_2008 = {
    'a': 'alfa', 'b': 'bravo', 'c': 'charlie', 'd': 'delta', 'e': 'echo', 'f': 'foxtrot', 'g': 'golf', 'h': 'hotel', 'i': 'india', 'j': 'juliett', 'k': 'kilo', 'l': 'lima', 'm': 'mike', 'n': 'november', 'o': 'oscar', 'p': 'papa', 'q': 'quebec', 'r': 'romeo', 's': 'sierra', 't': 'tango', 'u': 'uniform', 'v': 'victor', 'w': 'whiskey', 'x': 'x-ray', 'y': 'yankee', 'z': 'zulu'
}

# 1951 ICAO code words
spelling_alphabet_icao_1951 = {
    'a': 'alfa', 'b': 'bravo', 'c': 'coca', 'd': 'delta', 'e': 'echo', 'f': 'foxtrot', 'g': 'gold', 'h': 'hotel', 'i': 'india', 'j': 'juliett', 'k': 'kilo', 'l': 'lima', 'm': 'metro', 'n': 'nectar', 'o': 'oscar', 'p': 'papa', 'q': 'quebec', 'r': 'romeo', 's': 'sierra', 't': 'tango', 'u': 'union', 'v': 'victor', 'w': 'whiskey', 'x': 'extra', 'y': 'yankee', 'z': 'zulu'
}

# 1949 ICAO code words
spelling_alphabet_icao_1949 = {
    'a': 'alfa', 'b': 'beta', 'c': 'coca', 'd': 'delta', 'e': 'echo', 'f': 'foxtrot', 'g': 'golf', 'h': 'hotel', 'i': 'india', 'j': 'julietta', 'k': 'kilo', 'l': 'lima', 'm': 'metro', 'n': 'nectar', 'o': 'oscar', 'p': 'papa', 'q': 'quebec', 'r': 'romeo', 's': 'sierra', 't': 'tango', 'u': 'union', 'v': 'victor', 'w': 'whiskey', 'x': 'x-ray', 'y': 'yankee', 'z': 'zebra'
}

# 1947 ICAO Latin America/Caribbean
spelling_alphabet_icao_1947_1 = {
    'a': 'ana', 'b': 'brazil', 'c': 'coco', 'd': 'dado', 'e': 'elsa', 'f': 'fiesta', 'g': 'gato', 'h': 'hombre', 'i': 'india', 'j': 'julio', 'k': 'kilo', 'l': 'luis', 'm': 'mama', 'n': 'norma', 'o': 'opera', 'p': 'peru', 'q': 'quebec', 'r': 'rosa', 's': 'sara', 't': 'tomas', 'u': 'uruguay', 'v': 'victor', 'w': 'whiskey', 'x': 'equis', 'y': 'yolanda', 'z': 'zeta'
}

# 1947 ICAO alphabet (adopted exactly from ARRL)
spelling_alphabet_icao_1947_2 = {
    'a': 'adam', 'b': 'baker', 'c': 'charlie', 'd': 'david', 'e': 'edward', 'f': 'freddie', 'g': 'george', 'h': 'harry', 'i': 'ida', 'j': 'john', 'k': 'king', 'l': 'luis', 'm': 'mama', 'n': 'norma', 'o': 'opera', 'p': 'peru', 'q': 'quebec', 'r': 'rosa', 's': 'sara', 't': 'tomas', 'u': 'uruguay', 'v': 'victor', 'w': 'whiskey', 'x': 'equis', 'y': 'yolanda', 'z': 'zeta'
}

# Chemical Symbol
chemical_symbol = {
    '1': 'H', '2': 'He', '3': 'Li', '4': 'Be', '5': 'B', '6': 'C', '7': 'N', '8': 'O', '9': 'F', '10': 'Ne', '11': 'Na', '12': 'Mg', '13': 'Al', '14': 'Si', '15': 'P', '16': 'S', '17': 'Cl', '18': 'Ar', '19': 'K', '20': 'Ca', '21': 'Sc', '22': 'Ti', '23': 'V', '24': 'Cr', '25': 'Mn', '26': 'Fe', '27': 'Co', '28': 'Ni', '29': 'Cu', '30': 'Zn', '31': 'Ga', '32': 'Ge', '33': 'As', '34': 'Se', '35': 'Br', '36': 'Kr', '37': 'Rb', '38': 'Sr', '39': 'Y', '40': 'Zr', '41': 'Nb', '42': 'Mo', '43': 'Tc', '44': 'Ru', '45': 'Rh', '46': 'Pd', '47': 'Ag', '48': 'Cd', '49': 'In', '50': 'Sn', '51': 'Sb', '52': 'Te', '53': 'I', '54': 'Xe', '55': 'Cs', '56': 'Ba', '57': 'La', '58': 'Ce', '59': 'Pr', '60': 'Nd', '61': 'Pm', '62': 'Sm', '63': 'Eu', '64': 'Gd', '65': 'Tb', '66': 'Dy', '67': 'Ho', '68': 'Er', '69': 'Tm', '70': 'Yb', '71': 'Lu', '72': 'Hf', '73': 'Ta', '74': 'W', '75': 'Re', '76': 'Os', '77': 'Ir', '78': 'Pt', '79': 'Au', '80': 'Hg', '81': 'Tl', '82': 'Pb', '83': 'Bi', '84': 'Po', '85': 'At', '86': 'Rn', '87': 'Fr', '88': 'Ra', '89': 'Ac', '90': 'Th', '91': 'Pa', '92': 'U', '93': 'Np', '94': 'Pu', '95': 'Am', '96': 'Cm', '97': 'Bk', '98': 'Cf', '99': 'Es', '100': 'Fm', '101': 'Md', '102': 'No', '103': 'Lr', '104': 'Rf', '105': 'Db', '106': 'Sg', '107': 'Bh', '108': 'Hs', '109': 'Mt', '110': 'Ds', '111': 'Rg', '112': 'Cn', '113': 'Nh', '114': 'Fl', '115': 'Mc', '116': 'Lv', '117': 'Ts', '118': 'Og'
}

braille_table = {
    '000000': '20',    '011101': '21',    '000010': '22',    '001111': '23',    '110101': '24',
    '100101': '25',    '111101': '26',    '001000': '27',    '111011': '28',    '011111': '29',
    '100001': '2A',    '001101': '2B',    '000001': '2C',    '001001': '2D',    '000101': '2E',
    '001100': '2F',    '001011': '30',    '010000': '31',    '011000': '32',    '010010': '33',
    '010011': '34',    '010001': '35',    '011010': '36',    '011011': '37',    '011001': '38',
    '001010': '39',    '100011': '3A',    '000011': '3B',    '110001': '3C',    '111111': '3D',
    '001110': '3E',    '100111': '3F',    '000100': '40',    '100000': '41',    '110000': '42',
    '100100': '43',    '100110': '44',    '100010': '45',    '110100': '46',    '110110': '47',
    '110010': '48',    '010100': '49',    '010110': '4A',    '101000': '4B',    '111000': '4C',
    '101100': '4D',    '101110': '4E',    '101010': '4F',    '111100': '50',    '111110': '51',
    '111010': '52',    '011100': '53',    '011110': '54',    '101001': '55',    '111001': '56',
    '010111': '57',    '101101': '58',    '101111': '59',    '101011': '5A',    '010101': '5B',
    '110011': '5C',    '110111': '5D',    '000110': '5E',    '000111': '5F',
}

braille_ja_table = {
    '000000100000': 'あ',    '000000110000': 'い',    '000000100100': 'う',    '000000110100': 'え',    '000000010100': 'お',
    '000000100001': 'か',    '000000110001': 'き',    '000000100101': 'く',    '000000110101': 'け',    '000000010101': 'こ',
    '000000100011': 'さ',    '000000110011': 'し',    '000000100111': 'す',    '000000110111': 'せ',    '000000010111': 'そ',
    '000000101010': 'た',    '000000111010': 'ち',    '000000101110': 'つ',    '000000111110': 'て',    '000000011110': 'と',
    '000000101000': 'な',    '000000111000': 'に',    '000000101100': 'ぬ',    '000000111100': 'ね',    '000000011100': 'の',
    '000000101001': 'は',    '000000111001': 'ひ',    '000000101101': 'ふ',    '000000111101': 'へ',    '000000011101': 'ほ',
    '000000101011': 'ま',    '000000111011': 'み',    '000000101111': 'む',    '000000111111': 'め',    '000000011111': 'も',
    '000000001100': 'や',    '000000001101': 'ゆ',    '000000001110': 'よ',
    '000000100010': 'ら',    '000000110010': 'り',    '000000100110': 'る',    '000000110110': 'れ',    '000000010110': 'ろ',
    '000000001000': 'わ',    '000000011000': 'ゐ',    '000000001010': 'を',    '000000001011': 'ん',
    '000000010000': 'っ',    '000000010010': 'ー',
    '000000000011': '、',    '000000010011': '。',    '000000010001': '？',    '000000011010': '！',    '000000000010': '・',
    '000010000000': '濁音',
    '000010100001': 'が',    '000010110001': 'ぎ',    '000010100101': 'ぐ',    '000010110101': 'げ',    '000010010101': 'ご',
    '000010100011': 'ざ',    '000010110011': 'じ',    '000010100111': 'ず',    '000010110111': 'ぜ',    '000010010111': 'ぞ',
    '000010101010': 'だ',    '000010111010': 'ぢ',    '000010101110': 'づ',    '000010111110': 'で',    '000010011110': 'ど',
    '000010101001': 'ば',    '000010111001': 'び',    '000010101101': 'ぶ',    '000010111101': 'べ',    '000010011101': 'ぼ',
    '000001000000': '半濁音',
    '000001101001': 'ぱ',    '000001111001': 'ぴ',    '000001101101': 'ぷ',    '000001111101': 'ぺ',    '000001011101': 'ぽ',
    '000100000000': '拗音',
    '000100100001': 'きゃ',    '000100100101': 'きゅ',    '000100010101': 'きょ',
    '000100100011': 'しゃ',    '000100100111': 'しゅ',    '000100010111': 'しょ',
    '000100101010': 'ちゃ',    '000100101110': 'ちゅ',    '000100011110': 'ちょ',
    '000100101000': 'にゃ',    '000100101100': 'にゅ',    '000100011100': 'にょ',
    '000100101001': 'ひゃ',    '000100101101': 'ひゅ',    '000100011101': 'ひょ',
    '000100101011': 'みゃ',    '000100101111': 'みゅ',    '000100011111': 'みょ',
    '000100100010': 'りゃ',    '000100100110': 'りゅ',    '000100010110': 'りょ',
    '000110000000': '濁音+拗音',
    '000110100001': 'ぎゃ',    '000110100101': 'ぎゅ',    '000110010101': 'ぎょ',
    '000110100011': 'じゃ',    '000110100111': 'じゅ',    '000110010111': 'じょ',
    '000110101010': 'ぢゃ',    '000110101110': 'ぢゅ',    '000110011110': 'ぢょ',
    '000110101001': 'びゃ',    '000110101101': 'びゅ',    '000110011101': 'びょ',
    '000101000000': '半濁音+拗音',
    '000101101001': 'ぴゃ',    '000101101101': 'ぴゅ',    '000101011101': 'ぴょ',
    '000011000000': '外字符',
    '000011100000': 'A',    '000011110000': 'B',    '000011100100': 'C',    '000011100110': 'D',    '000011100010': 'E',
    '000011110100': 'F',    '000011110110': 'G',    '000011110010': 'H',    '000011010100': 'I',    '000011010110': 'J',
    '000011101000': 'K',    '000011111000': 'L',    '000011101100': 'M',    '000011101110': 'N',    '000011101010': 'O',
    '000011111100': 'P',    '000011111110': 'Q',    '000011111010': 'R',    '000011011100': 'S',    '000011011110': 'T',
    '000011101001': 'U',    '000011111001': 'V',    '000011010111': 'W',    '000011101101': 'X',    '000011101111': 'Y',
    '000011101011': 'Z',
    '001111000000': '数符',
    '001111100000': '1',    '001111110000': '2',    '001111100100': '3',    '001111100110': '4',    '001111100010': '5',
    '001111110100': '6',    '001111110110': '7',    '001111110010': '8',    '001111010100': '9',    '001111010110': '0',
}
